export const flavors = [
  { name: "Classic", category: "Unli Wings", description: "Original fried chicken flavor", rating: 4, image: "classic.png" },
  { name: "Cheese", category: "Unli Wings", description: "Creamy cheese flavor", rating: 5, image: "cheese.png" },
  { name: "Garlic Parmesan", category: "Unli Wings", description: "Savory garlic with parmesan", rating: 5, image: "garlicparmesan.png" },
  { name: "Lemon Glazed", category: "Unli Wings", description: "Tangy lemon glaze", rating: 4.5, image: "lemonglazed.png" },
  { name: "Salted Egg", category: "Unli Wings", description: "Rich salted egg flavor", rating: 5, image: "saltedegg.png" },
  { name: "Spice Maple", category: "Unli Wings", description: "Sweet and spicy maple", rating: 4, image: "spicemaple.png" },
  { name: "Sweet and Sour", category: "Unli Wings", description: "Classic sweet & sour", rating: 4, image: "sweetandsour.png" },
  { name: "Gravy", category: "Unli Wings", description: "Creamy gravy flavor", rating: 4.5, image: "gravy.png" },
  { name: "Mango Habanero", category: "Unli Wings", description: "Sweet mango with habanero heat", rating: 4, image: "mangohabanero.png" },
  { name: "Spicy Salted Egg", category: "Unli Wings", description: "Salted egg with a spicy kick", rating: 5, image: "spicysaltedegg.png" },
  { name: "Spicy Korean", category: "Unli Wings", description: "Korean-style spicy glaze", rating: 4, image: "spicykorean.png" },
  { name: "Sriracha", category: "Unli Wings", description: "Classic sriracha flavor", rating: 4, image: "sriracha.png" },
  { name: "Spicy Buffalo", category: "Unli Wings", description: "Classic buffalo wings", rating: 4.5, image: "buffalo.png" },
  { name: "Sweet Chili", category: "Unli Wings", description: "Thai-style sweet chili", rating: 4, image: "sweetchili.png" },
  { name: "Hickory Barbeque", category: "Unli Wings", description: "Smoky barbeque flavor", rating: 4.5, image: "hickorybbq.png" },
  { name: "Soy Garlic", category: "Unli Wings", description: "Savory soy garlic", rating: 5, image: "soygarlic.png" },
  { name: "Honey Butter", category: "Unli Wings", description: "Sweet honey butter", rating: 5, image: "honeybutter.png" },
  { name: "Teriyaki", category: "Unli Wings", description: "Japanese-style teriyaki glaze", rating: 4, image: "teriyaki.png" }
];

export const menuItems = [
  { name: "Unli Wings, Java, and Iced tea", category: "Combo Meals", price: "‚Ç±359.00", description: "All-you-can-eat wings with drinks", image: "unli.png" },
  { name: "Chix and Chips", category: "Combo Meals", price: "‚Ç±239.00", description: "Chicken steak + Fries + Glass of Iced tea", image: "logo.png" },
  { name: "Meat Lovers", category: "Combo Meals", price: "‚Ç±239.00", description: "3pcs Wings + Hungarian + Java + Glass of Iced tea", image: "meatlovers.png" },
  { name: "King Feast", category: "Combo Meals", price: "‚Ç±319.00", description: "Chix Sakto + Hungarian + Java + Fries + Glass of Iced tea", image: "kingfeast.png" },
  { name: "Sulit Meal", category: "Ala Carte", price: "‚Ç±129.00", description: "3pcs + Java Rice (1 flavor)", image: "sulit.png" },
  { name: "Busog Meal", category: "Ala Carte", price: "‚Ç±199.00", description: "6pcs + Java Rice (2 flavors)", image: "busog.png" },
  { name: "Chix Sakto", category: "Ala Carte", price: "‚Ç±169.00", description: "5pcs wings (1 flavor)", image: "sakto.png" },
  { name: "Chix Steakzilla", category: "Ala Carte", price: "‚Ç±189.00", description: "Chickensteak + Java Rice", image: "steakzilla.png" },
  { name: "Jumbo Cheesy Hungarian", category: "Ala Carte", price: "‚Ç±129.00", description: "Jumbo Hungarian + Java Rice", image: "hungarian.png" },
  { name: "Small Bilao", category: "Bilao", price: "‚Ç±429.00", description: "1kg Wings (3 flavors)", image: "smallbilao.png" },
  { name: "Medium Bilao", category: "Bilao", price: "‚Ç±549.00", description: "1.5kg Wings (5 flavors)", image: "mediumbilao.png" },
  { name: "Large Bilao", category: "Bilao", price: "‚Ç±999.00", description: "3kg Wings (8 flavors)", image: "largebilao.png" },
  { name: "Couple Bundle", category: "Bilao", price: "‚Ç±499.00", description: "Small bilao + 2 java rice + 2 coke mismo", image: "couple.jpg" },
  { name: "Family Bundle", category: "Bilao", price: "‚Ç±699.00", description: "Medium bilao + 4 java rice + 1 coke 1.5L", image: "family.jpg" },
  { name: "Fiesta Bundle", category: "Bilao", price: "‚Ç±1299.00", description: "Large bilao + 6 java rice + 2 coke 1.5L", image: "fiesta.jpg" },
  { name: "Big Pitcher Iced Tea", category: "Beverages", price: "‚Ç±89.00", description: "Refreshing iced tea", image: "bigpitcher.png" },
  { name: "Small Pitcher Iced Tea", category: "Beverages", price: "‚Ç±69.00", description: "Refreshing iced tea", image: "smallpitcher.png" },
  { name: "Glass of Iced tea", category: "Beverages", price: "‚Ç±20.00", description: "Refreshing iced tea", image: "icedtea.png" },
  { name: "Softdrinks Mismo", category: "Beverages", price: "‚Ç±30.00", description: "Coke mismo 300ml", image: "mismo.png" },
  { name: "Softdrinks 1.5L", category: "Beverages", price: "‚Ç±99.00", description: "Coke 1.5 liter", image: "coke.png" },
  { name: "Bottled Water", category: "Beverages", price: "‚Ç±20.00", description: "Purified water", image: "water.png" },
  { name: "Extra Java", category: "Extras", price: "‚Ç±30.00", description: "Java rice", image: "java.png" },
  { name: "Cheesy Overload Fries", category: "Extras", price: "‚Ç±69.00", description: "Overload cheese fries", image: "cheesefries.jpg" },
  { name: "BBQ Overload Fries", category: "Extras", price: "‚Ç±69.00", description: "Overload BBQ fries", image: "bbqfries.jpg" },
  { name: "Extra Sauce", category: "Extras", price: "‚Ç±25.00", description: "Special chicken sauce", image: "sauces.png" },
  { name: "Garlic Mayo Dip", category: "Extras", price: "‚Ç±30.00", description: "Garlic Mayo dipping sauce", image: "mayo.png" }
];

export const games = [
  {
    name: "UNO",
    image: "uno.jpg",
    short: "Classic card game of colors, numbers, and strategy.",
    instructions: `üéØ Objective: Be the first to 500 points (or win individual rounds by emptying your hand).

üë• Ideal Players: 2‚Äì10 (best with 3‚Äì6).

üõ† Setup:
- Shuffle and deal 7 cards to each player.
- Place the rest as a Draw Pile.
- Flip 1 card face up to start the Discard Pile.

‚ñ∂Ô∏è How to Play:
- Match the Discard Pile card by color, number, or symbol.
- If you can‚Äôt, draw from the Draw Pile. If playable, you may play it.
- Turns proceed clockwise unless reversed.

üîπ Special Cards:
- Skip ‚Üí next player loses a turn.
- Reverse ‚Üí order of play switches.
- Draw Two (+2) ‚Üí next player draws 2 and skips.
- Wild ‚Üí choose the color.
- Wild +4 ‚Üí choose color + next player draws 4 (must be unplayable otherwise).

‚ö†Ô∏è Special Rule:
- If you have 1 card left, you must shout ‚ÄúUNO!‚Äù If another player catches you before your next turn, draw 2 cards.

üèÜ Winning:
- First to 500 points, or winner of the final round if playing casually.`
  },
  {
    name: "Cluedo",
    image: "cluedo.png",
    short: "Deduction game: find the killer, weapon, and room.",
    instructions: `üéØ Objective: Identify the murderer, weapon, and crime scene.

üë• Ideal Players: 3‚Äì6 (best with 4‚Äì5).

üõ† Setup:
- Shuffle and secretly place 1 suspect, 1 weapon, and 1 room card in the Confidential Envelope.
- Distribute the remaining cards evenly among players.
- Place weapons in random rooms. Each player chooses a suspect token.

‚ñ∂Ô∏è How to Play:
- Roll dice and move across the board.
- Enter a room to make a suggestion (e.g., "Miss Scarlet with the Rope in the Kitchen").
- The next player clockwise must show you 1 matching card if possible.
- Use your detective sheet to mark off seen cards.
- When confident, make an accusation in the center room.

üèÜ Winning:
- Correct accusation = victory.
- Wrong accusation = eliminated (but you must still reveal cards if asked).`
  },
  {
    name: "Exploding Kittens",
    image: "explodingkittens.png",
    short: "Don‚Äôt draw an exploding kitten or you‚Äôre out!",
    instructions: `üéØ Objective: Stay alive and avoid drawing an Exploding Kitten.

üë• Ideal Players: 2‚Äì5 (best with 3‚Äì5).

üõ† Setup:
- Deal 7 cards + 1 Defuse to each player.
- Shuffle in Exploding Kittens (1 fewer than number of players).
- Add extra Defuses into the deck.

‚ñ∂Ô∏è How to Play:
- On your turn, play any number of cards (optional), then draw 1 card.
- If you draw an Exploding Kitten:
  - If you have a Defuse, play it and put the Kitten back secretly anywhere in the deck.
  - If not, you‚Äôre eliminated.
- Action cards: Attack (next player takes 2 turns), Skip, See the Future, Shuffle, Favor, Combos.

üèÜ Winning:
- Last surviving player.`
  },
  {
    name: "Werewolf",
    image: "werewolf.png",
    short: "Hidden roles: villagers vs. werewolves.",
    instructions: `üéØ Objective: Villagers eliminate Werewolves before Werewolves equal/outnumber villagers.

üë• Ideal Players: 7‚Äì20 (best with 9‚Äì15).

üõ† Setup:
- Assign roles secretly: Werewolves, Villagers, and optional Seer, Doctor, etc.
- A moderator runs the game and doesn‚Äôt play.

‚ñ∂Ô∏è How to Play:
- Night Phase: Everyone closes eyes. Werewolves choose a victim. Seer checks someone‚Äôs role. Doctor may save someone.
- Day Phase: Moderator reveals the victim (if not saved). Players debate and vote someone out.
- Eliminated players reveal their role and leave discussion but still show cards if relevant.

üèÜ Winning:
- Villagers win if all Werewolves are eliminated.
- Werewolves win if they equal or outnumber Villagers.`
  },
  {
    name: "Guess Who?",
    image: "guesswho.png",
    short: "Yes/No questions to guess your opponent‚Äôs character.",
    instructions: `üéØ Objective: Be the first to guess your opponent‚Äôs character.

üë• Ideal Players: 2.

üõ† Setup:
- Each player selects (or is dealt) a secret character.
- Both players have boards with all characters upright.

‚ñ∂Ô∏è How to Play:
- Ask yes/no questions to eliminate possibilities.
  (e.g., "Does your character wear glasses?")
- Flip down characters that don‚Äôt fit the answer.
- You may guess the character instead of asking. Wrong guess = loss.

üèÜ Winning:
- First to correctly guess the opponent‚Äôs character.`
  },
  {
    name: "Jenga",
    image: "jenga.jpg",
    short: "Don‚Äôt be the one to topple the tower.",
    instructions: `üéØ Objective: Keep the tower standing as long as possible.

üë• Ideal Players: 2‚Äì8 (best with 3‚Äì5).

üõ† Setup:
- Stack 54 wooden blocks in alternating layers of 3.

‚ñ∂Ô∏è How to Play:
- On your turn, remove 1 block from anywhere below the top layer.
- Place it carefully on top, perpendicular to the row below.
- Play continues clockwise.

üèÜ Winning:
- Last player to successfully place a block before the tower collapses.`
  },
  {
    name: "Taco Cat Goat Cheese Pizza",
    image: "tacocat.png",
    short: "Fast-paced pattern-matching slap game.",
    instructions: `üéØ Objective: Get rid of all your cards by playing and slapping correctly.

üë• Ideal Players: 3‚Äì8 (best with 4‚Äì6).

üõ† Setup:
- Deal all cards face down evenly to players.

‚ñ∂Ô∏è How to Play:
- Players take turns placing the top card from their deck face-up in the center while saying "Taco ‚Üí Cat ‚Üí Goat ‚Üí Cheese ‚Üí Pizza" in order.
- If the spoken word matches the card, everyone slaps the pile. Last to slap takes it.
- Special Cards:
  - Gorilla ‚Üí pound chest 3 times + slap
  - Narwhal ‚Üí make horn gesture + slap
  - Groundhog ‚Üí knock table + slap

üèÜ Winning:
- First to get rid of all cards.`
  },
  {
    name: "Spot It",
    image: "spotit.jpg",
    short: "Find the matching symbol faster than everyone else.",
    instructions: `üéØ Objective: Be the fastest to spot the symbol between two cards.

üë• Ideal Players: 2‚Äì8 (best with 3‚Äì6).

üõ† Setup:
- Each card has 8 symbols. Any 2 cards share exactly 1 symbol.

‚ñ∂Ô∏è How to Play:
- Reveal 2 cards at a time.
- The first player to call out the matching symbol either collects or discards cards, depending on the variant.
- Continue until deck is exhausted.

üèÜ Winning:
- Depends on chosen variant. Usually, most cards = winner or first with no cards left.`
  }
];

export const unliPrice = 329.00;

export function initializeCustomerMenu() {
  const allItems = [...menuItems];
  const menuList = document.getElementById("menuList");
  const searchBar = document.getElementById("searchBar");
  const categoryButtons = document.querySelectorAll(".category-tabs button");
  const priceHeader = document.querySelector(".unli-price-header");

  let currentSearchTerm = "";
  let currentCategory = "all";

  function renderMenu(items, category = "all") {
    menuList.innerHTML = "";

    // ‚úÖ Handle Games separately
    if (category === "Games") {
      priceHeader.style.display = "none";

      const filteredGames = currentSearchTerm
        ? games.filter(game =>
            game.name.toLowerCase().includes(currentSearchTerm) ||
            game.short.toLowerCase().includes(currentSearchTerm)
          )
        : games;

      filteredGames.forEach(game => {
        const card = createCard(game, true); // isGame = true
        menuList.appendChild(card);

        // Click = open modal
        card.addEventListener("click", () => {
          document.getElementById("gameTitle").textContent = game.name;
          document.getElementById("gameInstructions").innerText = game.instructions;
          document.getElementById("gameModal").style.display = "block";
        });
      });
      return;
    }

    if (category === "Unli Wings") {
      priceHeader.style.display = "block";
      priceHeader.textContent = `Unlimited Wings - ‚Ç±${unliPrice.toFixed(2)}`;

      const filteredFlavors = currentSearchTerm
        ? flavors.filter(flavor =>
            flavor.name.toLowerCase().includes(currentSearchTerm) ||
            flavor.description.toLowerCase().includes(currentSearchTerm)
          )
        : flavors;

      filteredFlavors.forEach(flavor => {
        const card = createCard(flavor);
        menuList.appendChild(card);
      });
      return;
    } else {
      priceHeader.style.display = "none";
    }

    if (category === "all") {
      // Show Unli Wings summary card first
      if (
        !currentSearchTerm ||
        "unli wings".includes(currentSearchTerm) ||
        "all-you-can-eat chicken wings".includes(currentSearchTerm)
      ) {
        const unliCard = document.createElement("div");
        unliCard.className = "menu-card";
        unliCard.innerHTML = `
          <img src="img/unli.png" alt="Unli Wings" />
          <div class="content">
            <h3>Unli Wings</h3>
            <p>All-you-can-eat chicken wings</p>
            <div class="details">
              <span class="price">‚Ç±${unliPrice.toFixed(2)}</span>
            </div>
          </div>
        `;
        menuList.appendChild(unliCard);
      }

      const categories = {};
      const filteredItems = currentSearchTerm
        ? allItems.filter(item =>
            item.name.toLowerCase().includes(currentSearchTerm) ||
            item.description.toLowerCase().includes(currentSearchTerm)
          )
        : allItems;

      filteredItems.forEach(item => {
        if (!categories[item.category]) categories[item.category] = [];
        categories[item.category].push(item);
      });

      Object.entries(categories).forEach(([categoryName, categoryItems]) => {
        if (categoryItems.length > 0) {
          const categoryHeader = document.createElement("h2");
          categoryHeader.className = "category-header";
          categoryHeader.textContent = categoryName;
          menuList.appendChild(categoryHeader);

          categoryItems.forEach(item => {
            const card = createCard(item);
            menuList.appendChild(card);
          });
        }
      });
    } else {
      const filteredItems = allItems.filter(item =>
        item.category === category &&
        (!currentSearchTerm ||
          item.name.toLowerCase().includes(currentSearchTerm) ||
          item.description.toLowerCase().includes(currentSearchTerm))
      );
      filteredItems.forEach(item => {
        const card = createCard(item);
        menuList.appendChild(card);
      });
    }
  }

  function createCard(item, isGame = false) {
    const card = document.createElement("div");
    card.className = "menu-card";

    let detailsContent = "";
    if (item.rating) {
      const fullStars = "‚òÖ".repeat(Math.floor(item.rating));
      const halfStar = item.rating % 1 >= 0.5 ? "¬Ω" : "";
      detailsContent = `<div class="rating">${fullStars}${halfStar}</div>`;
    } else if (item.price) {
      detailsContent = `<span class="price">${item.price}</span>`;
    }

    card.innerHTML = `
      <img src="img/${item.image || "sample.jpg"}" alt="${item.name}" />
      <div class="content">
        <h3>${item.name}</h3>
        <p>${isGame ? item.short : item.description}</p>
        <div class="details">${detailsContent}</div>
      </div>
    `;

    return card;
  }

  // Init
  renderMenu(allItems);

  // Search
  searchBar.addEventListener("input", (e) => {
    currentSearchTerm = e.target.value.toLowerCase();
    renderMenu(allItems, currentCategory);
  });

  // Category buttons
  categoryButtons.forEach(button => {
    button.addEventListener("click", () => {
      categoryButtons.forEach(btn => btn.classList.remove("active"));
      button.classList.add("active");

      currentCategory = button.dataset.category;
      renderMenu(allItems, currentCategory);
    });
  });

  // Close modal logic
  document.querySelectorAll(".close-modal").forEach(btn => {
    btn.addEventListener("click", () => {
      btn.closest(".modal").style.display = "none";
    });
  });

  // Close modal when clicking outside content
  window.addEventListener("click", (e) => {
    if (e.target.classList.contains("modal")) {
      e.target.style.display = "none";
    }
  });
}
